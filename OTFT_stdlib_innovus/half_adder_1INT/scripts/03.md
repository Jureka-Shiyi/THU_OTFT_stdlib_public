在执行 `03_place.tcl`（布局阶段）后，你遇到了非常关键的 **ERROR (IMPSP-2021)**。这个错误意味着工具有 **2个实例（instances）无法找到合法的放置位置**，这通常会导致后续流程（如时钟树综合 CTS 和绕线）无法正常进行。

以下是针对报错信息的详细排查与解决方案：

---

## 1. 核心问题分析：Legalization 失败

### **ERROR: IMPSP-2021 & WARNING: IMPSP-2020 (Could not legalize...)**

* **含义**：工具在尝试将 Standard Cells 放置到 Row 上时，发现有些单元怎么放都会造成重叠或违反设计规则（DRC）。
* **可能原因**：
1. **Placement Blockage 太大**：你可能在某些区域设置了过严的阻挡，导致单元没地方放。
2. **电源线（PG Stripe）阻挡**：有时电源条带占用了过多的金属层空间，或者电源轨（Rails）没对齐，导致工具认为该区域无法放置。
3. **Core 区域太小/拥塞**：设计面积太窄，导致某些尺寸较大的单元无法塞进去。
4. **Pin 对齐问题**：结合之前的 `IMPFP-4026` 警告，如果你的 Row 没有对齐到制造格点，工具可能无法在非法位置“安家”。



**建议操作**：

* 在 GUI 中查看放置失败的实例。执行 `checkPlace` 命令，或者在 Violation Browser 中查看具体是哪两个 Cell 无法 Legalize。
* 检查是否有固定（Fixed）位置的单元或 Macro 挡住了布局路径。

---

## 2. 严重的优化警告 (IMPOPT-3535 / 3532)

### **WARNING: No usable buffer has been found**

* **含义**：Innovus 在进行布局优化（OptDesign）时，**找不到可以使用的 Buffer（缓冲器）或 Inverter（反相器）**。
* **后果**：工具无法修复 Hold/Setup Time 违规，也无法修复设计中的大负载（Max Capacitance）问题。
* **解决方案**：
* 检查你的 `set_dont_use` 列表。你可能不小心把库里所有的 Buffer 都设为了 `dont_use`。
* 检查库文件加载。确认 `.lib` 文件中确实包含具有 `buffer` 或 `inverter` 属性的单元。
* **关键步骤**：在脚本中手动定义 Buffer Footprint，例如：
`set_db opt_buffer_self_footprint <buffer_cell_name>`



---

## 3. 寄生参数提取警告 (IMPEXT-6197)

### **WARNING: The Cap table file is not specified**

* **含义**：你没有加载 **Cap Table** 文件。
* **影响**：Innovus 现在只能使用预设的（通常是过时的）缩放因子来估算电容。这会导致 **时序分析极度不准确**，在 Place 阶段看到的 Slack 可能是假的。
* **解决方案**：
* 在初始化脚本中添加：`set_db cap_table_file <your_file>.captable`。
* 或者使用更现代的 QRC 技术库（.ict 或 .tch 文件）。



---

## 4. 汇总：你应该如何修复？

建议按以下顺序调整脚本：

1. **修复库定义（最优先）**：
确认你的 `set_db init_lef_file` 和 `set_db init_lib_file` 路径正确。确保 Buffer 单元在库中是可见且可用的。
2. **检查 Floorplan 对齐**：
回到 `01_floorplan.tcl`。确保 `floorPlan` 的起始坐标和尺寸是 Site 宽度和高度的整数倍。如果对齐有问题，后续的 Legalize 报错（IMPSP-2021）通常源于此。
3. **处理 PG 连接问题**：
你在 `02_pg_stripe.tcl` 中有 2 个连接性违反。**如果电源轨（Follower Rails）没有正确生成，Standard Cells 将无法正常 Legalize（放置）**，因为它们必须紧贴电源轨。
* 请务必先解决 `verify_connectivity` 的报错，再运行 `place_opt_design`。



### 建议尝试的调试命令：

在 Innovus 控制台中输入：

```tcl
checkPlace ;# 检查布局合法性
report_pnet_cut ;# 检查电源网络是否切断了过多的布局空间

```

**你想让我帮你看看如何修改 `02` 脚本中的电源轨（Rails）连接吗？这很可能是导致 `03` 放置失败的真凶。**